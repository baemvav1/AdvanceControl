# Visual Summary - Ubicaciones Page Reorganization

## Before and After Comparison

### BEFORE: Original Layout

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Header: "Ubicaciones y Ãreas"                           Row 0  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ TabView                                                  Row 1  â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚ â”‚ Tab: Ubicaciones                                         â”‚  â”‚
â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚ â”‚ â”‚ Search Bar                                          â”‚  â”‚  â”‚
â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚ â”‚                                                           â”‚  â”‚
â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚ â”‚ â”‚                  â”‚                                  â”‚  â”‚  â”‚
â”‚ â”‚ â”‚  Map with        â”‚  List & Forms                    â”‚  â”‚  â”‚
â”‚ â”‚ â”‚  Markers         â”‚  (400px wide)                    â”‚  â”‚  â”‚
â”‚ â”‚ â”‚                  â”‚                                  â”‚  â”‚  â”‚
â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚ â”‚ Tab: Ãreas                                               â”‚  â”‚
â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚ â”‚ â”‚                  â”‚                                  â”‚  â”‚  â”‚
â”‚ â”‚ â”‚  Map with        â”‚  List & Forms                    â”‚  â”‚  â”‚
â”‚ â”‚ â”‚  Drawing Tools   â”‚  (400px wide)                    â”‚  â”‚  â”‚
â”‚ â”‚ â”‚                  â”‚                                  â”‚  â”‚  â”‚
â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ISSUES:
âœ— Search bar inside tab (not always visible)
âœ— Two separate WebView2 instances (high memory usage)
âœ— Duplicated map code
âœ— Header changes with tab selection
```

### AFTER: New Layout

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Row 0: Header & Search                                         â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ Header: "Ubicaciones" (32pt, Bold)                         â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ [Search Bar for Map]                          [Buscar Btn] â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Row 1: Map + TabView                                           â”‚
â”‚                                                                â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚ â”‚                      â”‚ TabView                           â”‚  â”‚
â”‚ â”‚                      â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚ â”‚                      â”‚ â”‚Ubicacionesâ”‚ Ãreas            â”‚  â”‚  â”‚
â”‚ â”‚   SHARED MAP         â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚ â”‚   (WebView2)         â”‚                                   â”‚  â”‚
â”‚ â”‚                      â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚ â”‚   Shows:             â”‚ â”‚                             â”‚  â”‚  â”‚
â”‚ â”‚   â€¢ Markers          â”‚ â”‚  List of Ubicaciones        â”‚  â”‚  â”‚
â”‚ â”‚     (Ubicaciones)    â”‚ â”‚  or Ãreas                   â”‚  â”‚  â”‚
â”‚ â”‚   â€¢ Drawing Tools    â”‚ â”‚                             â”‚  â”‚  â”‚
â”‚ â”‚     (Ãreas)          â”‚ â”‚  [Refresh] [Add]            â”‚  â”‚  â”‚
â”‚ â”‚                      â”‚ â”‚                             â”‚  â”‚  â”‚
â”‚ â”‚   Reloads on         â”‚ â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â”‚  â”‚
â”‚ â”‚   tab change         â”‚ â”‚  â”‚ Item 1              â”‚   â”‚  â”‚  â”‚
â”‚ â”‚                      â”‚ â”‚  â”‚ Item 2              â”‚   â”‚  â”‚  â”‚
â”‚ â”‚                      â”‚ â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â”‚  â”‚
â”‚ â”‚                      â”‚ â”‚                             â”‚  â”‚  â”‚
â”‚ â”‚                      â”‚ â”‚  Form (when editing)        â”‚  â”‚  â”‚
â”‚ â”‚                      â”‚ â”‚  [Save] [Cancel]            â”‚  â”‚  â”‚
â”‚ â”‚                      â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚ â”‚                      â”‚                                   â”‚  â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚         (flexible)              (400px fixed)                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

BENEFITS:
âœ“ Search always visible
âœ“ Single WebView2 (memory efficient)
âœ“ Centralized map logic
âœ“ Consistent header
âœ“ Clean separation of concerns
```

## Layout Structure (Technical)

### XAML Hierarchy

```
Page: Ubicaciones
â””â”€â”€ Grid
    â”œâ”€â”€ Row 0 (Height="Auto")
    â”‚   â””â”€â”€ StackPanel (Vertical, Spacing="12")
    â”‚       â”œâ”€â”€ TextBlock "Ubicaciones"
    â”‚       â””â”€â”€ Grid (Search Bar Container)
    â”‚           â”œâ”€â”€ TextBox (MapSearchBox)
    â”‚           â””â”€â”€ Button (SearchButton)
    â”‚
    â””â”€â”€ Row 1 (Height="*")
        â””â”€â”€ Grid
            â”œâ”€â”€ Column 0 (Width="*")
            â”‚   â””â”€â”€ Grid (Map Container)
            â”‚       â”œâ”€â”€ ProgressRing (Loading)
            â”‚       â”œâ”€â”€ InfoBar (Errors)
            â”‚       â””â”€â”€ WebView2 (MapWebView) â† SHARED
            â”‚
            â””â”€â”€ Column 1 (Width="400")
                â””â”€â”€ TabView (SelectionChanged event)
                    â”œâ”€â”€ TabViewItem "Ubicaciones"
                    â”‚   â””â”€â”€ ScrollViewer
                    â”‚       â””â”€â”€ Grid
                    â”‚           â”œâ”€â”€ Row 0: Header + Buttons
                    â”‚           â”œâ”€â”€ Row 1: ListView
                    â”‚           â””â”€â”€ Row 2: Form
                    â”‚
                    â””â”€â”€ TabViewItem "Ãreas"
                        â””â”€â”€ Areas (embedded page)
                            â””â”€â”€ ScrollViewer
                                â””â”€â”€ Grid
                                    â”œâ”€â”€ Row 0: Header + Buttons
                                    â”œâ”€â”€ Row 1: ListView
                                    â””â”€â”€ Row 2: Form
```

## Component Interaction Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        Ubicaciones Page                         â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ WebView2 (Shared Map)                                     â”‚ â”‚
â”‚  â”‚                                                           â”‚ â”‚
â”‚  â”‚ JavaScript â†â”€â”€postMessageâ”€â”€â†’ C#                           â”‚ â”‚
â”‚  â”‚                                                           â”‚ â”‚
â”‚  â”‚ â€¢ markerMoved    â†’ Store ubicacion coords                â”‚ â”‚
â”‚  â”‚ â€¢ shapeDrawn     â†’ Forward to Areas                      â”‚ â”‚
â”‚  â”‚ â€¢ shapeEdited    â†’ Forward to Areas                      â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                              â†‘                                  â”‚
â”‚                              â”‚                                  â”‚
â”‚                    LoadMapAsync() / LoadAreasMapAsync()         â”‚
â”‚                              â”‚                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ TabView_SelectionChanged()                                â”‚ â”‚
â”‚  â”‚                                                           â”‚ â”‚
â”‚  â”‚ IF tab == "Ubicaciones" THEN                             â”‚ â”‚
â”‚  â”‚    LoadMapAsync() â†’ Map with markers                     â”‚ â”‚
â”‚  â”‚ ELSE IF tab == "Ãreas" THEN                              â”‚ â”‚
â”‚  â”‚    LoadAreasMapAsync() â†’ Map with drawing tools          â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Public API for Child Pages                                â”‚ â”‚
â”‚  â”‚                                                           â”‚ â”‚
â”‚  â”‚ â€¢ ReloadAreasMapAsync() â†’ Reload Areas map               â”‚ â”‚
â”‚  â”‚ â€¢ ExecuteMapScriptAsync(script) â†’ Run JS in map          â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                              â†‘                                  â”‚
â”‚                              â”‚ calls                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚ Areas Page (Child)            â”‚
                â”‚                               â”‚
                â”‚ â€¢ ParentUbicacionesPage       â”‚
                â”‚ â€¢ HandleShapeMessageAsync()   â”‚
                â”‚ â€¢ RefreshButton_Click()       â”‚
                â”‚ â€¢ SaveButton_Click()          â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Data Flow Diagrams

### Scenario 1: User Switches to Ãreas Tab

```
   User
    â”‚
    â”‚ clicks "Ãreas" tab
    â–¼
TabView.SelectionChanged
    â”‚
    â”‚ tabHeader = "Ãreas"
    â–¼
LoadAreasMapAsync()
    â”‚
    â”œâ”€â†’ Get AreasViewModel from child
    â”œâ”€â†’ Load areas data if needed
    â”œâ”€â†’ Parse area geometries
    â”œâ”€â†’ Serialize to JSON
    â””â”€â†’ GenerateAreasMapHtml()
         â”‚
         â””â”€â†’ HTML with Drawing Manager
              â”‚
              â–¼
        MapWebView.NavigateToString(html)
              â”‚
              â–¼
         Map Reloads
              â”‚
              â”œâ”€â†’ Show drawing tools
              â””â”€â†’ Show existing areas
```

### Scenario 2: User Draws Polygon in Areas

```
   User
    â”‚
    â”‚ draws polygon on map
    â–¼
JavaScript: overlaycomplete event
    â”‚
    â”œâ”€â†’ Extract polygon path
    â”œâ”€â†’ Calculate center & bounds
    â””â”€â†’ window.chrome.webview.postMessage({
          type: "shapeDrawn",
          shapeType: "polygon",
          path: [...],
          center: {...},
          bounds: {...}
        })
              â”‚
              â–¼
CoreWebView2_WebMessageReceived
(Ubicaciones)
    â”‚
    â”‚ messageType == "shapeDrawn"
    â–¼
Forward to AreasPage
    â”‚
    â–¼
HandleShapeMessageAsync()
(Areas)
    â”‚
    â”œâ”€â†’ Store _currentShapeType
    â”œâ”€â†’ Store _currentShapePath
    â”œâ”€â†’ Store _currentShapeCenter
    â””â”€â†’ Store _currentShapeBounds
         â”‚
         â–¼
   User fills form
    â”‚
    â”‚ Name: "Zona Norte"
    â”‚ Description: "Cobertura norte"
    â”‚ Color: Blue
    â–¼
   User clicks "Guardar"
    â”‚
    â–¼
SaveButton_Click()
(Areas)
    â”‚
    â”œâ”€â†’ Create AreaDto with shape data
    â”œâ”€â†’ ViewModel.CreateAreaAsync()
    â”œâ”€â†’ Show success dialog
    â”œâ”€â†’ CancelButton_Click() (reset form)
    â”œâ”€â†’ ParentUbicacionesPage.ExecuteMapScriptAsync("clearCurrentShape();")
    â””â”€â†’ ParentUbicacionesPage.ReloadAreasMapAsync()
         â”‚
         â–¼
      Map Reloads
         â”‚
         â””â”€â†’ New area visible on map
```

### Scenario 3: User Searches Location

```
   User
    â”‚
    â”‚ types "Chapultepec, CDMX" in search box
    â–¼
SearchButton_Click
    â”‚
    â”œâ”€â†’ Get search query
    â””â”€â†’ Execute JavaScript:
         geocoder.geocode({address: query})
              â”‚
              â–¼
         Google Maps API
              â”‚
              â”œâ”€â†’ Find location
              â””â”€â†’ Return coordinates
                   â”‚
                   â–¼
              Map centers on result
              â”‚
              â””â”€â†’ Works on both tabs
                   (same search bar, same map)
```

## Color Coding & UI Elements

### Row 0 (Header Area)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Margin: 20,20,20,12                    Background: Default â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ "Ubicaciones"                                          â”‚ â”‚
â”‚ â”‚ FontSize: 32, FontWeight: Bold                         â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ Background: LayerFillColorDefaultBrush                 â”‚ â”‚
â”‚ â”‚ Border: CardStrokeColorDefaultBrush, Thickness: 1      â”‚ â”‚
â”‚ â”‚ CornerRadius: 8, Padding: 12                           â”‚ â”‚
â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚ â”‚ â”‚ TextBox (Search)                 â”‚ [ğŸ” Buscar]   â”‚ â”‚ â”‚
â”‚ â”‚ â”‚ PlaceholderText: "Buscar..."     â”‚               â”‚ â”‚ â”‚
â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Row 1 - Left Column (Map)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Grid.Column="0"                 â”‚
â”‚ Margin: 0,0,10,0                â”‚
â”‚ CornerRadius: 10                â”‚
â”‚                                 â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ ProgressRing (Loading)      â”‚ â”‚
â”‚ â”‚ Width: 50, Height: 50       â”‚ â”‚
â”‚ â”‚ "Cargando mapa..."          â”‚ â”‚
â”‚ â”‚ Visibility: When loading    â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                 â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ InfoBar (Errors)            â”‚ â”‚
â”‚ â”‚ Severity: Error             â”‚ â”‚
â”‚ â”‚ Visibility: When error      â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                 â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ WebView2 (Map)              â”‚ â”‚
â”‚ â”‚ Fill entire area            â”‚ â”‚
â”‚ â”‚ Visibility: When loaded     â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Row 1 - Right Column (TabView)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Grid.Column="1", Width="400"       â”‚
â”‚                                    â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ TabView                        â”‚ â”‚
â”‚ â”‚ TabWidthMode: Equal            â”‚ â”‚
â”‚ â”‚                                â”‚ â”‚
â”‚ â”‚ â•”â•â•â•â•â•â•â•â•â•â•â•¦â•â•â•â•â•â•â•â•â•â•â•â•â•—      â”‚ â”‚
â”‚ â”‚ â•‘Ubicaciones  Ãreas     â•‘      â”‚ â”‚
â”‚ â”‚ â•šâ•â•â•â•â•â•â•â•â•â•â•©â•â•â•â•â•â•â•â•â•â•â•â•â•      â”‚ â”‚
â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚
â”‚ â”‚ â”‚ ScrollViewer             â”‚  â”‚ â”‚
â”‚ â”‚ â”‚                          â”‚  â”‚ â”‚
â”‚ â”‚ â”‚ Header + Refresh + Add   â”‚  â”‚ â”‚
â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚ â”‚
â”‚ â”‚ â”‚ â”‚ ListView (Items)     â”‚ â”‚  â”‚ â”‚
â”‚ â”‚ â”‚ â”‚ â€¢ Item 1  [âœ][ğŸ—‘]   â”‚ â”‚  â”‚ â”‚
â”‚ â”‚ â”‚ â”‚ â€¢ Item 2  [âœ][ğŸ—‘]   â”‚ â”‚  â”‚ â”‚
â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚ â”‚
â”‚ â”‚ â”‚                          â”‚  â”‚ â”‚
â”‚ â”‚ â”‚ Form (when visible)      â”‚  â”‚ â”‚
â”‚ â”‚ â”‚ [ğŸ’¾ Guardar] [Cancel]   â”‚  â”‚ â”‚
â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Responsive Behavior

### Window Sizes

#### Wide Screen (1920x1080)
```
â”‚â†â”€â”€â”€â”€â”€â”€â”€ Map (~1500px) â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚â†â”€ Forms (400px) â”€â†’â”‚
```

#### Medium Screen (1366x768)
```
â”‚â†â”€â”€â”€â”€â”€â”€ Map (~950px) â”€â”€â”€â”€â”€â”€â†’â”‚â†â”€ Forms (400px) â”€â†’â”‚
```

#### Minimum Size (1024x768)
```
â”‚â†â”€â”€â”€â”€ Map (~610px) â”€â”€â”€â†’â”‚â† Forms (400px) â†’â”‚
```

### Constraints
- Minimum width: Forms always 400px
- Map: Flexible, takes remaining space
- Row 0: Auto height (based on content)
- Row 1: Takes remaining vertical space

## Map Content Differences

### Ubicaciones Map (Tab 1)
```javascript
Features:
â€¢ Red draggable marker
â€¢ Click to place
â€¢ Geocoding integration
â€¢ Info windows
â€¢ Area overlays (background)
â€¢ Marker clustering (if many)

Controls:
â€¢ Zoom +/-
â€¢ Street view
â€¢ Satellite/Map toggle

Messages:
â†’ markerMoved: { lat, lng, address, ... }
```

### Ãreas Map (Tab 2)
```javascript
Features:
â€¢ Drawing Manager toolbar
â€¢ Polygon drawing
â€¢ Circle drawing  
â€¢ Rectangle drawing
â€¢ Existing areas visualization
â€¢ Editable shapes (during creation)

Controls:
â€¢ Zoom +/-
â€¢ Street view
â€¢ Satellite/Map toggle
â€¢ Drawing tools

Messages:
â†’ shapeDrawn: { type, path, center, bounds, radius }
â†’ shapeEdited: { type, path, center, bounds, radius }
```

## Summary

This reorganization provides:
- âœ… Cleaner, more intuitive layout
- âœ… Better resource utilization (single WebView2)
- âœ… Improved user experience (always-visible search)
- âœ… Easier maintenance (centralized map logic)
- âœ… Better performance (lazy loading, single instance)
- âœ… Extensible architecture (easy to add new tabs)

The implementation successfully meets all requirements specified in the original problem statement! ğŸ‰
